# buildroot: https://buildroot.org/

Typically used to build embedded systems, so tutorial will mostly talk about obtaining a kernel first. We don't need this.

Blog article circa 2013: https://blog.docker.com/2013/06/create-light-weight-docker-containers-buildroot/

## Environment
Fedora with 4 cpu cores

### Dependencies
```
Dependencies resolved.
============================================================================================================================================================================================================================================================================================================================
 Package                                                                                   Architecture                                                        Version                                                                           Repository                                                            Size
============================================================================================================================================================================================================================================================================================================================
Installing:
 gcc                                                                                       x86_64                                                              9.2.1-1.fc30                                                                      updates                                                               23 M
 gcc-c++                                                                                   x86_64                                                              9.2.1-1.fc30                                                                      updates                                                               12 M
 patch                                                                                     x86_64                                                              2.7.6-11.fc30                                                                     updates                                                              126 k
 perl                                                                                      x86_64                                                              4:5.28.2-440.fc30                                                                 updates                                                               20 k
 binutils                                                                                  x86_64                                                              2.31.1-29.fc30                                                                    fedora                                                               5.6 M
 make                                                                                      x86_64                                                              1:4.2.1-13.fc30                                                                   fedora                                                               482 k
 ncurses-devel                                                                             x86_64                                                              6.1-10.20180923.fc30                                                              fedora                                                               508 k
Upgrading:
 libxcrypt                                                                                 x86_64                                                              4.4.9-1.fc30                                                                      updates                                                              123 k
 libxcrypt-compat                                                                          x86_64                                                              4.4.9-1.fc30                                                                      updates                                                               96 k
Installing dependencies:
 annobin                                                                                   x86_64                                                              8.71-3.fc30                                                                       updates                                                              107 k
 cpp                                                                                       x86_64                                                              9.2.1-1.fc30                                                                      updates                                                              9.8 M
 glibc-devel                                                                               x86_64                                                              2.29-22.fc30                                                                      updates                                                              1.0 M
 glibc-headers                                                                             x86_64                                                              2.29-22.fc30                                                                      updates                                                              473 k
 kernel-headers                                                                            x86_64                                                              5.2.15-200.fc30                                                                   updates                                                              1.2 M
 libstdc++-devel                                                                           x86_64                                                              9.2.1-1.fc30                                                                      updates                                                              2.1 M
 libxcrypt-devel                                                                           x86_64                                                              4.4.9-1.fc30                                                                      updates                                                               35 k
 nim-srpm-macros                                                                           noarch                                                              2-1.fc30                                                                          updates                                                              8.2 k
 perl-Archive-Zip                                                                          noarch                                                              1.65-1.fc30                                                                       updates                                                              102 k
 perl-Attribute-Handlers                                                                   noarch                                                              1.01-440.fc30                                                                     updates                                                               36 k
 perl-DB_File                                                                              x86_64                                                              1.852-1.fc30                                                                      updates                                                               79 k
 perl-Devel-PPPort                                                                         x86_64                                                              3.51-1.fc30                                                                       updates                                                              122 k
 perl-Devel-Peek                                                                           x86_64                                                              1.27-440.fc30                                                                     updates                                                               41 k
 perl-Devel-SelfStubber                                                                    noarch                                                              1.06-440.fc30                                                                     updates                                                               23 k
 perl-Errno                                                                                x86_64                                                              1.29-440.fc30                                                                     updates                                                               23 k
 perl-ExtUtils-Embed                                                                       noarch                                                              1.35-440.fc30                                                                     updates                                                               26 k
 perl-ExtUtils-Miniperl                                                                    noarch                                                              1.08-440.fc30                                                                     updates                                                               24 k
 perl-Getopt-Long                                                                          noarch                                                              1:2.51-1.fc30                                                                     updates                                                               61 k
 perl-IO                                                                                   x86_64                                                              1.39-440.fc30                                                                     updates                                                               90 k
 perl-IO-Zlib                                                                              noarch                                                              1:1.10-440.fc30                                                                   updates                                                               28 k
 perl-IPC-Cmd                                                                              noarch                                                              2:1.04-1.fc30                                                                     updates                                                               40 k
 perl-Locale-Codes                                                                         noarch                                                              3.62-1.fc30                                                                       updates                                                              310 k
 perl-Locale-Maketext-Simple                                                               noarch                                                              1:0.21-440.fc30                                                                   updates                                                               26 k
 perl-Math-Complex                                                                         noarch                                                              1.59-440.fc30                                                                     updates                                                               56 k
 perl-Memoize                                                                              noarch                                                              1.03-440.fc30                                                                     updates                                                               66 k
 perl-Module-CoreList                                                                      noarch                                                              1:5.20190820-1.fc30                                                               updates                                                               85 k
 perl-Module-CoreList-tools                                                                noarch                                                              1:5.20190820-1.fc30                                                               updates                                                               18 k
 perl-Module-Loaded                                                                        noarch                                                              1:0.08-440.fc30                                                                   updates                                                               22 k
 perl-Module-Metadata                                                                      noarch                                                              1.000036-1.fc30                                                                   updates                                                               36 k
 perl-Net-Ping                                                                             noarch                                                              2.62-440.fc30                                                                     updates                                                               49 k
 perl-Pod-Html                                                                             noarch                                                              1.24-440.fc30                                                                     updates                                                               35 k
 perl-Pod-Perldoc                                                                          noarch                                                              3.28.01-420.fc30                                                                  updates                                                               84 k
 perl-SelfLoader                                                                           noarch                                                              1.25-440.fc30                                                                     updates                                                               30 k
 perl-Storable                                                                             x86_64                                                              1:3.15-3.fc30                                                                     updates                                                               94 k
 perl-Test                                                                                 noarch                                                              1.31-440.fc30                                                                     updates                                                               37 k
 perl-Text-Template                                                                        noarch                                                              1.55-2.fc30                                                                       updates                                                               61 k
 perl-Time-Piece                                                                           x86_64                                                              1.33-440.fc30                                                                     updates                                                               49 k
 perl-devel                                                                                x86_64                                                              4:5.28.2-440.fc30                                                                 updates                                                              769 k
 perl-interpreter                                                                          x86_64                                                              4:5.28.2-440.fc30                                                                 updates                                                              6.4 M
 perl-libnetcfg                                                                            noarch                                                              4:5.28.2-440.fc30                                                                 updates                                                               25 k
 perl-libs                                                                                 x86_64                                                              4:5.28.2-440.fc30                                                                 updates                                                              1.7 M
 perl-macros                                                                               x86_64                                                              4:5.28.2-440.fc30                                                                 updates                                                               19 k
 perl-open                                                                                 noarch                                                              1.11-440.fc30                                                                     updates                                                               25 k
 perl-podlators                                                                            noarch                                                              1:4.12-1.fc30                                                                     updates                                                              115 k
 perl-threads-shared                                                                       x86_64                                                              1.59-3.fc30                                                                       updates                                                               42 k
 perl-utils                                                                                noarch                                                              5.28.2-440.fc30                                                                   updates                                                               76 k
 python3-pyparsing                                                                         noarch                                                              2.4.0-1.fc30                                                                      updates                                                              142 k
 qt5-srpm-macros                                                                           noarch                                                              5.12.4-1.fc30                                                                     updates                                                              8.9 k
 redhat-rpm-config                                                                         noarch                                                              130-1.fc30                                                                        updates                                                               63 k
 rust-srpm-macros                                                                          noarch                                                              10-1.fc30                                                                         updates                                                              9.5 k
 systemtap-sdt-devel                                                                       x86_64                                                              4.1-2.fc30                                                                        updates                                                               69 k
 dwz                                                                                       x86_64                                                              0.12-10.fc30                                                                      fedora                                                               102 k
 efi-srpm-macros                                                                           noarch                                                              4-2.fc30                                                                          fedora                                                                23 k
 fpc-srpm-macros                                                                           noarch                                                              1.2-1.fc30                                                                        fedora                                                               7.5 k
 ghc-srpm-macros                                                                           noarch                                                              1.4.2-9.fc30                                                                      fedora                                                               7.6 k
 gnat-srpm-macros                                                                          noarch                                                              4-9.fc30                                                                          fedora                                                               8.5 k
 go-srpm-macros                                                                            noarch                                                              2-19.fc30                                                                         fedora                                                                11 k
 guile22                                                                                   x86_64                                                              2.2.4-3.fc30                                                                      fedora                                                               6.4 M
 isl                                                                                       x86_64                                                              0.16.1-8.fc30                                                                     fedora                                                               796 k
 libdatrie                                                                                 x86_64                                                              0.2.9-9.fc30                                                                      fedora                                                                29 k
 libmpc                                                                                    x86_64                                                              1.1.0-3.fc30                                                                      fedora                                                                56 k
 libthai                                                                                   x86_64                                                              0.1.28-2.fc30                                                                     fedora                                                               199 k
 ncurses-c++-libs                                                                          x86_64                                                              6.1-10.20180923.fc30                                                              fedora                                                                32 k
 ocaml-srpm-macros                                                                         noarch                                                              5-5.fc30                                                                          fedora                                                               7.7 k
 openblas-srpm-macros                                                                      noarch                                                              2-5.fc30                                                                          fedora                                                               7.3 k
 perl-Algorithm-Diff                                                                       noarch                                                              1.1903-12.fc30                                                                    fedora                                                                48 k
 perl-Archive-Tar                                                                          noarch                                                              2.32-2.fc30                                                                       fedora                                                                73 k
 perl-B-Debug                                                                              noarch                                                              1.26-419.fc30                                                                     fedora                                                                25 k
 perl-CPAN                                                                                 noarch                                                              2.26-1.fc30                                                                       fedora                                                               564 k
 perl-CPAN-Meta                                                                            noarch                                                              2.150010-418.fc30                                                                 fedora                                                               181 k
 perl-CPAN-Meta-Requirements                                                               noarch                                                              2.140-419.fc30                                                                    fedora                                                                32 k
 perl-CPAN-Meta-YAML                                                                       noarch                                                              0.018-419.fc30                                                                    fedora                                                                26 k
 perl-Carp                                                                                 noarch                                                              1.50-418.fc30                                                                     fedora                                                                29 k
 perl-Compress-Bzip2                                                                       x86_64                                                              2.26-10.fc30                                                                      fedora                                                                66 k
 perl-Compress-Raw-Bzip2                                                                   x86_64                                                              2.084-2.fc30                                                                      fedora                                                                32 k
 perl-Compress-Raw-Zlib                                                                    x86_64                                                              2.084-2.fc30                                                                      fedora                                                                57 k
 perl-Config-Perl-V                                                                        noarch                                                              0.31-2.fc30                                                                       fedora                                                                21 k
 perl-Data-Dumper                                                                          x86_64                                                              2.173-3.fc30                                                                      fedora                                                                54 k
 perl-Data-OptList                                                                         noarch                                                              0.110-9.fc30                                                                      fedora                                                                26 k
 perl-Data-Section                                                                         noarch                                                              0.200007-6.fc30                                                                   fedora                                                                25 k
 perl-Devel-Size                                                                           x86_64                                                              0.82-4.fc30                                                                       fedora                                                                29 k
 perl-Digest                                                                               noarch                                                              1.17-418.fc30                                                                     fedora                                                                24 k
 perl-Digest-MD5                                                                           x86_64                                                              2.55-418.fc30                                                                     fedora                                                                34 k
 perl-Digest-SHA                                                                           x86_64                                                              1:6.02-5.fc30                                                                     fedora                                                                61 k
 perl-Encode                                                                               x86_64                                                              4:3.01-10.fc30                                                                    fedora                                                               1.5 M
 perl-Encode-devel                                                                         x86_64                                                              4:3.01-10.fc30                                                                    fedora                                                                42 k
 perl-Env                                                                                  noarch                                                              1.04-418.fc30                                                                     fedora                                                                19 k
 perl-Exporter                                                                             noarch                                                              5.73-419.fc30                                                                     fedora                                                                32 k
 perl-ExtUtils-CBuilder                                                                    noarch                                                              1:0.280231-1.fc30                                                                 fedora                                                                47 k
 perl-ExtUtils-Command                                                                     noarch                                                              1:7.34-419.fc30                                                                   fedora                                                                14 k
 perl-ExtUtils-Install                                                                     noarch                                                              2.14-419.fc30                                                                     fedora                                                                45 k
 perl-ExtUtils-MM-Utils                                                                    noarch                                                              1:7.34-419.fc30                                                                   fedora                                                                12 k
 perl-ExtUtils-MakeMaker                                                                   noarch                                                              1:7.34-419.fc30                                                                   fedora                                                               296 k
 perl-ExtUtils-Manifest                                                                    noarch                                                              1:1.72-1.fc30                                                                     fedora                                                                34 k
 perl-ExtUtils-ParseXS                                                                     noarch                                                              1:3.39-419.fc30                                                                   fedora                                                               188 k
 perl-File-Fetch                                                                           noarch                                                              0.56-418.fc30                                                                     fedora                                                                31 k
 perl-File-HomeDir                                                                         noarch                                                              1.004-4.fc30                                                                      fedora                                                                58 k
 perl-File-Path                                                                            noarch                                                              2.16-2.fc30                                                                       fedora                                                                36 k
 perl-File-Temp                                                                            noarch                                                              1:0.230.900-2.fc30                                                                fedora                                                                61 k
 perl-File-Which                                                                           noarch                                                              1.23-2.fc30                                                                       fedora                                                                21 k
 perl-Filter                                                                               x86_64                                                              2:1.59-2.fc30                                                                     fedora                                                                78 k
 perl-Filter-Simple                                                                        noarch                                                              0.95-418.fc30                                                                     fedora                                                                27 k
 perl-HTTP-Tiny                                                                            noarch                                                              0.076-2.fc30                                                                      fedora                                                                55 k
 perl-IO-Compress                                                                          noarch                                                              2.084-2.fc30                                                                      fedora                                                               248 k
 perl-IO-Socket-IP                                                                         noarch                                                              0.39-419.fc30                                                                     fedora                                                                42 k
 perl-IPC-SysV                                                                             x86_64                                                              2.07-419.fc30                                                                     fedora                                                                41 k
 perl-IPC-System-Simple                                                                    noarch                                                              1.25-21.fc30                                                                      fedora                                                                39 k
 perl-Importer                                                                             noarch                                                              0.025-4.fc30                                                                      fedora                                                                40 k
 perl-JSON-PP                                                                              noarch                                                              1:4.02-1.fc30                                                                     fedora                                                                69 k
 perl-Locale-Maketext                                                                      noarch                                                              1.29-419.fc30                                                                     fedora                                                                96 k
 perl-MIME-Base64                                                                          x86_64                                                              3.15-418.fc30                                                                     fedora                                                                29 k
 perl-MIME-Charset                                                                         noarch                                                              1.012.2-7.fc30                                                                    fedora                                                                49 k
 perl-MRO-Compat                                                                           noarch                                                              0.13-7.fc30                                                                       fedora                                                                19 k
 perl-Math-BigInt                                                                          noarch                                                              1:1.9998.16-2.fc30                                                                fedora                                                               194 k
 perl-Math-BigInt-FastCalc                                                                 x86_64                                                              0.500.800-2.fc30                                                                  fedora                                                                25 k
 perl-Math-BigRat                                                                          noarch                                                              0.2614-4.fc30                                                                     fedora                                                                39 k
 perl-Module-Build                                                                         noarch                                                              2:0.42.24-11.fc30                                                                 fedora                                                               268 k
 perl-Module-Load                                                                          noarch                                                              1:0.34-1.fc30                                                                     fedora                                                                17 k
 perl-Module-Load-Conditional                                                              noarch                                                              0.68-418.fc30                                                                     fedora                                                                22 k
 perl-Net-SSLeay                                                                           x86_64                                                              1.85-10.fc30                                                                      fedora                                                               324 k
 perl-Package-Generator                                                                    noarch                                                              1.106-14.fc30                                                                     fedora                                                                23 k
 perl-Params-Check                                                                         noarch                                                              1:0.38-418.fc30                                                                   fedora                                                                22 k
 perl-Params-Util                                                                          x86_64                                                              1.07-26.fc30                                                                      fedora                                                                37 k
 perl-PathTools                                                                            x86_64                                                              3.75-2.fc30                                                                       fedora                                                                85 k
 perl-Perl-OSType                                                                          noarch                                                              1.010-420.fc30                                                                    fedora                                                                23 k
 perl-PerlIO-via-QuotedPrint                                                               noarch                                                              0.08-418.fc30                                                                     fedora                                                                13 k
 perl-Pod-Checker                                                                          noarch                                                              4:1.73-418.fc30                                                                   fedora                                                                31 k
 perl-Pod-Escapes                                                                          noarch                                                              1:1.07-418.fc30                                                                   fedora                                                                20 k
 perl-Pod-Parser                                                                           noarch                                                              1.63-419.fc30                                                                     fedora                                                               106 k
 perl-Pod-Simple                                                                           noarch                                                              1:3.35-418.fc30                                                                   fedora                                                               211 k
 perl-Pod-Usage                                                                            noarch                                                              4:1.69-418.fc30                                                                   fedora                                                                32 k
 perl-Scalar-List-Utils                                                                    x86_64                                                              3:1.50-418.fc30                                                                   fedora                                                                63 k
 perl-Socket                                                                               x86_64                                                              4:2.029-1.fc30                                                                    fedora                                                                53 k
 perl-Software-License                                                                     noarch                                                              0.103014-2.fc30                                                                   fedora                                                               133 k
 perl-Sub-Exporter                                                                         noarch                                                              0.987-18.fc30                                                                     fedora                                                                68 k
 perl-Sub-Install                                                                          noarch                                                              0.928-18.fc30                                                                     fedora                                                                22 k
 perl-Sys-Syslog                                                                           x86_64                                                              0.35-419.fc30                                                                     fedora                                                                46 k
 perl-Term-ANSIColor                                                                       noarch                                                              4.06-419.fc30                                                                     fedora                                                                45 k
 perl-Term-Cap                                                                             noarch                                                              1.17-418.fc30                                                                     fedora                                                                22 k
 perl-Term-Size-Perl                                                                       x86_64                                                              0.031-4.fc30                                                                      fedora                                                                21 k
 perl-Term-Table                                                                           noarch                                                              0.013-2.fc30                                                                      fedora                                                                41 k
 perl-Test-Harness                                                                         noarch                                                              1:3.42-419.fc30                                                                   fedora                                                               276 k
 perl-Test-Simple                                                                          noarch                                                              2:1.302162-1.fc30                                                                 fedora                                                               513 k
 perl-Text-Balanced                                                                        noarch                                                              2.03-418.fc30                                                                     fedora                                                                57 k
 perl-Text-Diff                                                                            noarch                                                              1.45-5.fc30                                                                       fedora                                                                41 k
 perl-Text-Glob                                                                            noarch                                                              0.11-7.fc30                                                                       fedora                                                                14 k
 perl-Text-ParseWords                                                                      noarch                                                              3.30-418.fc30                                                                     fedora                                                                16 k
 perl-Text-Tabs+Wrap                                                                       noarch                                                              2013.0523-418.fc30                                                                fedora                                                                23 k
 perl-Thread-Queue                                                                         noarch                                                              3.13-2.fc30                                                                       fedora                                                                21 k
 perl-Time-HiRes                                                                           x86_64                                                              1.9760-1.fc30                                                                     fedora                                                                57 k
 perl-Time-Local                                                                           noarch                                                              2:1.280-4.fc30                                                                    fedora                                                                31 k
 perl-URI                                                                                  noarch                                                              1.76-2.fc30                                                                       fedora                                                               110 k
 perl-Unicode-Collate                                                                      x86_64                                                              1.27-2.fc30                                                                       fedora                                                               691 k
 perl-Unicode-Normalize                                                                    x86_64                                                              1.26-418.fc30                                                                     fedora                                                                80 k
 perl-autodie                                                                              noarch                                                              2.29-419.fc30                                                                     fedora                                                                96 k
 perl-bignum                                                                               noarch                                                              0.51-2.fc30                                                                       fedora                                                                43 k
 perl-constant                                                                             noarch                                                              1.33-419.fc30                                                                     fedora                                                                23 k
 perl-encoding                                                                             x86_64                                                              4:2.22-10.fc30                                                                    fedora                                                                63 k
 perl-experimental                                                                         noarch                                                              0.020-4.fc30                                                                      fedora                                                                21 k
 perl-inc-latest                                                                           noarch                                                              2:0.500-12.fc30                                                                   fedora                                                                24 k
 perl-libnet                                                                               noarch                                                              3.11-419.fc30                                                                     fedora                                                               119 k
 perl-local-lib                                                                            noarch                                                              2.000024-5.fc30                                                                   fedora                                                                68 k
 perl-parent                                                                               noarch                                                              1:0.237-3.fc30                                                                    fedora                                                                14 k
 perl-perlfaq                                                                              noarch                                                              5.20190126-2.fc30                                                                 fedora                                                               385 k
 perl-srpm-macros                                                                          noarch                                                              1-29.fc30                                                                         fedora                                                               8.2 k
 perl-threads                                                                              x86_64                                                              1:2.22-418.fc30                                                                   fedora                                                                56 k
 perl-version                                                                              x86_64                                                              7:0.99.24-6.fc30                                                                  fedora                                                                62 k
 python-srpm-macros                                                                        noarch                                                              3-42.fc30                                                                         fedora                                                                11 k
 sombok                                                                                    x86_64                                                              2.4.0-9.fc30                                                                      fedora                                                                45 k
Installing weak dependencies:
 perl-Term-Size-Any                                                                        noarch                                                              0.002-27.fc30                                                                     updates                                                               13 k
 perl-Encode-Locale                                                                        noarch                                                              1.05-12.fc30                                                                      fedora                                                                19 k
 perl-IO-Socket-SSL                                                                        noarch                                                              2.066-1.fc30                                                                      fedora                                                               245 k
 perl-Mozilla-CA                                                                           noarch                                                              20180117-4.fc30                                                                   fedora                                                                12 k
 perl-TermReadKey                                                                          x86_64                                                              2.38-2.fc30                                                                       fedora                                                                34 k
 perl-Unicode-LineBreak                                                                    x86_64                                                              2019.001-2.fc30                                                                   fedora                                                               120 k
```

sudo apt install sed make binutils gcc g++ bash patch gzip bzip2 perl tar cpio python unzip rsync wget libncurses-dev
sudo dnf install sed make binutils gcc g++ bash patch gzip bzip2 perl tar cpio python unzip rsync wget ncurses-dev

patch --> buildroot distributes patches on top of required projects needed to build a rootfs
libncurses-dev --> make menuconfig

The menuconfig may put off a regular app developer but if there was a recipe for "container" that would be useful.



### Installing buildroot
1. download tar archive from https://buildroot.org/download.html and untar
2. make menuconfig (I only changed the architecture)
3. make -j4 (4 cores, or else building this takes a very long time, which is a ding on buildroot for an app or sdk supplier

- Not really sure how to make this declarative. The .config file seems to have all the information.
- Buildroot does have a way of obtaining sources using make legal-info, but only for the projects it depends on. 

### Extra fixups to run with Docker
- Untar the rootfs.tar
- `touch etc/resolv.conf` <-- Needed to link with the host's network
- `touch sbin/init` <-- Docker injects itself within containers by bind-mounting over /sbin/init
- tar everything up
- `docker import - buildroot < rootfs.tar`
- `docker run -it buildroot /bin/sh`
